def select(table: str, columns: 'list | tuple | str | None' = None, where: 'dict | None' = None): return (f'SELECT {"*" if (not isinstance(columns, (list, tuple, str))) or len(columns) <= 0 else ", ".join((columns,) if isinstance(columns, str) else columns)} FROM {table}' + (where_clause(**where) if isinstance(where, dict) else ''), (*(flatten(*where.values()) if isinstance(where, dict) else ()),))
def insert(table: str, values: 'dict | None' = None): return (f'INSERT INTO {table} {("(" + ", ".join(values) + ")") if isinstance(values, dict) and len(values) > 0 else "DEFAULT"} VALUES' + ((' (' + ', '.join('?' * len(values)) + ')') if isinstance(values, dict) and len(values) > 0 else ''), (*(values.values() if isinstance(values, dict) else ()),))
def update(table: str, where: 'dict | None' = None, returning: 'list | tuple | str | None' = None, set: 'dict | None' = None): return (f'UPDATE {table}' + ((' SET ' + ", ".join(f"{key} = ?" for key in set)) if isinstance(set, dict) and len(set) > 0 else '') + (where_clause(**where) if isinstance(where, dict) else '') + ((' RETURNING ' + (', '.join(key for key in ((returning,) if isinstance(returning, str) else returning)) if isinstance(returning, str) or len(returning) > 0 else '*')) if isinstance(returning, (list, tuple, str)) else ''), (*(set.values() if isinstance(set, dict) else ()), *(flatten(*where.values()) if isinstance(where, dict) else ())))
def delete(table: str, where: 'dict | None' = None): return (f'DELETE FROM {table}' + (where_clause(**where) if isinstance(where, dict) else ''), (*(flatten(*where.values()) if isinstance(where, dict) else ()),))

def where_clause(**conditions): return (' WHERE ' + ' AND '.join(f'{key} {"IN" if isinstance(value, (list, tuple)) else "="} {("(" + ", ".join("?" * len(value)) + ")") if isinstance(value, (list, tuple)) else "?"}' for key, value in conditions.items())) if len(conditions) > 0 else ''
def flatten(*values): return (*(value for sub in values for value in (sub if isinstance(sub, (list, tuple)) else (sub,))),)