def select(table: str, columns: 'list | None' = None, **where): return (f'SELECT {"*" if columns is None or len(columns) <= 0 else ", ".join(columns)} FROM {table}' + where_clause(**where), (*where.values(),))
def insert(table: str, **values): return (f'INSERT INTO {table} ({", ".join(values)}) VALUES ({", ".join("?" * len(values))})', (*values.values(),))
def update(table: str, where: 'dict | None' = None, returning: 'list | None' = None, **set): return (f'UPDATE {table}' + ((' SET ' + ", ".join(f"{key} = ?" for key in set)) if len(set) > 0 else '') + (where_clause(**where) if where is not None else '') + ((' RETURNING ' + (', '.join(key for key in returning) if len(returning) > 0 else '*')) if returning is not None else ''), (*set.values(), *(where.values() if where is not None else ())))
def delete(table: str, **where): return (f'DELETE FROM {table}' + where_clause(**where), (*where.values(),))

def where_clause(**conditions): return (' WHERE ' + ' AND '.join(f'{key} = ?' for key in conditions)) if len(conditions) > 0 else ''